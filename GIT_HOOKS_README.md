# Git post-commit钩子使用说明

## 功能介绍

此Git post-commit钩子用于在每次成功执行`git commit`命令后，自动将代码推送到GitHub仓库。

## 工作原理

1. 当你执行`git commit`并成功提交后，Git会自动运行`.git/hooks/post-commit`脚本
2. 脚本执行`git push`命令，将当前分支的代码推送到远程仓库
3. 脚本输出执行结果，显示推送成功或失败

## 使用方法

### 自动触发

无需额外操作，只需正常使用Git进行提交即可：

```bash
git add <文件名>
git commit -m "提交信息"
```

提交成功后，钩子会自动执行`git push`，并输出推送结果。

### 手动触发

如果需要手动推送代码，可以直接执行：

```bash
git push
```

## 常见问题及解决方案

### 1. 推送失败 - 网络连接问题

**症状**：钩子输出"❌ 推送失败！请检查网络连接或权限设置"

**解决方案**：
- 检查网络连接是否正常
- 确认能够访问GitHub网站
- 手动执行`git push`查看详细错误信息

### 2. 推送失败 - 权限问题

**症状**：钩子输出"❌ 推送失败！请检查网络连接或权限设置"

**解决方案**：
- 确认Git已正确配置GitHub凭据
- 检查是否有推送权限
- 尝试手动执行`git push`并输入用户名密码

### 3. 推送失败 - 分支冲突

**症状**：钩子输出推送失败，提示冲突

**解决方案**：
- 先执行`git pull`拉取最新代码
- 解决冲突后重新提交和推送

### 4. 钩子不执行

**症状**：提交成功后，没有看到钩子的输出信息

**解决方案**：
- 检查钩子文件是否存在：`.git/hooks/post-commit`
- 检查钩子文件是否有执行权限
- 手动执行钩子脚本：`sh .git/hooks/post-commit`，查看是否有错误

## 注意事项

1. **提交频率**：频繁提交可能导致提交记录过多，建议合理控制提交频率
2. **提交信息**：每次提交应使用有意义的提交信息，便于后续查看和维护
3. **分支管理**：钩子默认推送当前分支，确保当前分支已关联到远程分支
4. **公共分支**：在公共分支上操作时，建议先与团队成员沟通，避免冲突
5. **敏感信息**：不要提交包含敏感信息的文件，如密码、API密钥等
6. **钩子修改**：如需修改钩子脚本，直接编辑`.git/hooks/post-commit`文件即可

## 钩子脚本内容

钩子脚本使用Shell脚本编写，内容如下：

```bash
#!/bin/sh

echo "=== Git post-commit hook: 开始推送代码到GitHub ==="

# 执行git push命令
git push

if [ $? -eq 0 ]; then
    echo "✅ 推送成功！代码已同步到GitHub仓库"
else
    echo "❌ 推送失败！请检查网络连接或权限设置"
    echo "   错误代码: $?"
fi

echo "=== Git post-commit hook: 推送完成 ==="
```

## 禁用钩子

如需临时禁用钩子，可以将钩子文件重命名或删除：

```bash
# 重命名钩子文件，临时禁用
mv .git/hooks/post-commit .git/hooks/post-commit.disabled

# 恢复钩子文件
mv .git/hooks/post-commit.disabled .git/hooks/post-commit
```

## 卸载钩子

如需完全卸载钩子，直接删除钩子文件即可：

```bash
rm .git/hooks/post-commit
```

## 联系信息

如果遇到其他问题，欢迎随时咨询。